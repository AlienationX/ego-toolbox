{% extends 'base.html' %}
{% load django_htmx %}

{% block title %}{{ tool.title }} - Toolbox{% endblock %}

{% block content %}
<div class="tool-detail">
    <a href="{% url 'toolbox:index' %}" class="btn btn-ghost mb-6">← 返回首页</a>
    
    <div class="card bg-base-100 border border-base-200 rounded-xl p-8 mb-8">
        <div class="flex items-center gap-6">
            <div class="text-6xl p-5 bg-base-200 rounded-xl">{{ tool.icon }}</div>
            <h1 class="text-3xl font-bold">{{ tool.title }}</h1>
        </div>
    </div>
    
    <div class="card bg-base-100 border border-base-200 rounded-xl p-8">
        <p class="text-base-content/70 text-lg mb-8">{{ tool.description }}</p>
        
        <!-- 待办事项管理 -->
        <div class="todo-app">
            <h2 class="text-2xl font-bold mb-6">我的待办事项</h2>
            
            <!-- 添加新待办事项表单 -->
            <form hx-post="{% url 'toolbox:todo_add' %}" hx-target="#todo-list" hx-swap="beforeend" class="mb-8">
                {% csrf_token %}
                <div class="flex gap-3">
                    <input type="text" name="title" placeholder="添加新待办事项..." class="input input-bordered w-full">
                    <button type="submit" class="btn btn-primary">添加</button>
                </div>
            </form>
            
            <!-- 待办事项列表 -->
            <div id="todo-list" class="space-y-4">
                {% for todo in todos %}
                    <div class="todo-item card bg-base-100 border border-base-200 rounded-xl p-5 flex justify-between items-center shadow-sm hover:shadow-md transition-shadow duration-200">
                        <div class="flex items-center gap-4 flex-1 min-w-0">
                            <input 
                                type="checkbox" 
                                id="todo-{{ todo.id }}" 
                                hx-post="{% url 'toolbox:todo_toggle' todo.id %}" 
                                hx-target="closest .todo-item" 
                                hx-swap="outerHTML"
                                {% if todo.completed %}checked{% endif %} 
                                class="checkbox checkbox-primary checkbox-lg transition-all duration-200"
                            >
                            <label 
                                for="todo-{{ todo.id }}" 
                                class="text-lg font-medium cursor-pointer truncate transition-all duration-200 {% if todo.completed %}line-through text-base-content/50{% endif %}"
                            >
                                {{ todo.title }}
                            </label>
                        </div>
                        <button 
                            hx-delete="{% url 'toolbox:todo_delete' todo.id %}" 
                            hx-target="closest .todo-item" 
                            hx-swap="outerHTML"
                            class="btn btn-error btn-sm hover:btn-error/90 transition-all duration-200"
                        >
                            删除
                        </button>
                    </div>
                {% endfor %}
            </div>
            
            <!-- 空状态 -->
            {% if not todos %}
                <div class="card bg-base-200 border border-base-300 rounded-lg p-8 text-center">
                    <p class="text-lg text-base-content/70">暂无待办事项，点击上方按钮添加第一个待办事项吧！</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}